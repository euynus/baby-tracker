# language: zh-CN
功能: 睡眠记录与统计
  作为新手父母
  我想要记录宝宝的睡眠时间
  以便了解睡眠规律和确保充足休息

  背景:
    假如 我已经登录应用
    并且 我有一个名为"小宝"的宝宝档案

  场景: 开始睡眠计时
    假如 我在睡眠记录页面
    当 我点击"开始睡眠"按钮
    那么 计时器应该开始运行
    并且 按钮文本变为"结束睡眠"
    并且 计时显示格式为"HH:MM:SS"
    并且 开始时间应该记录为当前时间

  场景: 结束睡眠并保存记录
    假如 我已经开始睡眠计时
    并且 计时器运行了"02:30:00"
    当 我点击"结束睡眠"按钮
    那么 应该创建一条新的睡眠记录
    并且 记录应该包含:
      | 字段     | 值           |
      | 开始时间 | 2小时30分前  |
      | 结束时间 | 当前时间     |
      | 时长     | 2小时30分钟  |
    并且 记录应该出现在首页时间线中

  场景: 手动添加历史睡眠记录
    假如 我在睡眠记录页面
    当 我选择手动添加模式
    并且 我设置开始时间为"今天 14:00"
    并且 我设置结束时间为"今天 16:30"
    并且 我点击"保存"按钮
    那么 应该创建一条新的睡眠记录
    并且 时长应该自动计算为"2小时30分钟"

  场景: 添加睡眠备注
    假如 我正在创建睡眠记录
    当 我在备注栏输入"宝宝睡前喝了奶"
    并且 我保存记录
    那么 记录应该包含备注"宝宝睡前喝了奶"
    并且 备注应该在记录详情中显示

  场景: 查看今日睡眠统计
    假如 我有以下睡眠记录:
      | 开始时间    | 结束时间    | 时长      |
      | 今天 01:00 | 今天 03:30 | 2小时30分 |
      | 今天 07:00 | 今天 09:00 | 2小时     |
      | 今天 14:00 | 今天 15:30 | 1小时30分 |
    当 我进入统计页面
    那么 我应该看到:
      | 统计项       | 值        |
      | 今日睡眠次数 | 3次       |
      | 今日总睡眠   | 6小时     |
      | 平均单次时长 | 2小时     |
      | 最长睡眠     | 2小时30分 |

  场景: 查看7天睡眠趋势
    假如 我有过去7天的睡眠记录
    当 我进入统计页面
    并且 我选择"7天"时间范围
    那么 我应该看到睡眠趋势图表
    并且 图表应该显示每天的总睡眠时长
    并且 应该显示7天平均睡眠时长

  场景: 编辑已有睡眠记录
    假如 我有一条睡眠记录
    当 我点击该记录
    并且 我修改结束时间为"1小时后"
    并且 我保存修改
    那么 时长应该自动更新
    并且 统计数据应该重新计算

  场景: 删除错误的睡眠记录
    假如 我有一条错误的睡眠记录
    当 我在记录上左滑
    并且 点击"删除"按钮
    那么 记录应该被删除
    并且 统计数据应该更新
    并且 不再出现在时间线中

  场景: 睡眠质量标记
    假如 我正在创建睡眠记录
    当 我选择睡眠质量为"<质量>"
    并且 我保存记录
    那么 记录应该标记为"<质量>"
    并且 应该显示对应图标"<图标>"

    例子:
      | 质量 | 图标 |
      | 良好 | 😴   |
      | 一般 | 😐   |
      | 较差 | 😫   |

  场景: 夜间睡眠识别
    假如 我创建睡眠记录
    当 开始时间在"<时间段>"
    那么 系统应该自动标记为"<类型>"

    例子:
      | 时间段          | 类型   |
      | 22:00 - 06:00  | 夜间睡眠 |
      | 06:00 - 22:00  | 白天小睡 |

  场景: 睡眠提醒建议
    假如 当前时间是"21:00"
    并且 宝宝今天最后一次睡眠是"4小时前"
    当 我打开应用
    那么 应该显示提示"宝宝可能需要休息了"

  规则: 时长验证
    假如 我手动输入睡眠时长
    当 时长为"<时长>"
    那么 系统应该"<结果>"

    例子:
      | 时长      | 结果               |
      | 0分钟     | 提示"时长不能为零"   |
      | -1小时    | 提示"时长不能为负数" |
      | 15小时    | 提示"时长异常，请确认" |
      | 2小时30分 | 保存成功           |

  规则: 时间冲突检测
    假如 我已有一条睡眠记录"今天 14:00 - 16:00"
    当 我创建新记录"今天 15:00 - 17:00"
    那么 系统应该提示"时间冲突，请调整"
    并且 不允许保存

  场景: 睡眠中断记录
    假如 我正在睡眠计时
    当 宝宝在"01:30:00"时醒来
    并且 我点击"记录中断"
    并且 宝宝在"01:45:00"时继续睡眠
    并且 我点击"继续睡眠"
    那么 应该记录中断时长"15分钟"
    并且 总睡眠时长应该减去中断时间
